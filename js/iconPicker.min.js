"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var _slicedToArray=function(){function e(e,t){var i=[],a=!0,n=!1,r=void 0;try{for(var s,c=e[Symbol.iterator]();!(a=(s=c.next()).done)&&(i.push(s.value),!t||i.length!==t);a=!0);}catch(o){n=!0,r=o}finally{try{!a&&c["return"]&&c["return"]()}finally{if(n)throw r}}return i}return function(t,i){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,i);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),_createClass=function(){function e(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,i,a){return i&&e(t.prototype,i),a&&e(t,a),t}}(),fetchStyle=function(e){return new Promise(function(t,i){var a=document.createElement("link");if(a.type="text/css",a.rel="stylesheet",a.onload=function(){t()},a.href=e,!document.querySelector('link[href="'+e+'"]')){var n=document.querySelector("head");n.append(a)}})},IconPicker=function(){function e(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};_classCallCheck(this,e);var a={iconSets:[{name:"simpleLine",css:"https://cdnjs.cloudflare.com/ajax/libs/simple-line-icons/2.4.1/css/simple-line-icons.css",prefix:"icon-",displayPrefix:""},{name:"fontAwesome",css:"https://opensource.keycdn.com/fontawesome/4.7.0/font-awesome.min.css",prefix:"fa-",displayPrefix:"fa fa-icon"}]};this.element=t,this.options=Object.assign({},a,i),this.icons=[],this.id="iconPicker"+(new Date).getTime(),this.init()}return _createClass(e,[{key:"init",value:function(){var e=this;this.createModal(),this.createPreview(),this.options.iconSets.forEach(function(t){fetchStyle(t.css),fetch(t.css,{mode:"cors"}).then(function(e){return e.text()}).then(function(i){e.icons[t.name]=e.parseCSS(i,t.prefix||"fa-",t.displayPrefix||""),e.modalSetTabs.querySelector("a").click()})})}},{key:"createPreview",value:function(){var e=this;this.preview=document.createElement("div"),this.preview.className="icon is-large",this.preview.classList.add("iconpicker-preview");var t=document.createElement("i");if(t.className="iconpicker-icon-preview",this.element.value.length){var i=this.element.value.split(" ");i.forEach(function(e){t.classList.add(e)})}this.preview.appendChild(t),this.preview.addEventListener("click",function(t){t.preventDefault(),e.modal.classList.add("is-active")}),this.element.parentNode.insertBefore(this.preview,this.element.nextSibling)}},{key:"parseCSS",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"fa-",i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",a=new RegExp("\\."+t+"([^\\.!:]*)::?before\\s*{\\s*content:\\s*[\"|']\\\\[^'|\"]*[\"|'];?\\s*}","g"),n=1,r=[],s=void 0,c=void 0;c=a.exec(e);)s={prefix:t,selector:t+c[n].trim(":"),name:this.ucwords(c[n]).trim(":"),filter:c[n].trim(":"),displayPrefix:i},r[c[n]]=s;return 0==Object.getOwnPropertyNames(this.icons).length&&console.warn("No icons found in CSS file"),r}},{key:"ucwords",value:function(e){return(e+"").replace(/^(.)|\s+(.)/g,function(e){return e.toUpperCase()})}},{key:"drawIcons",value:function(e){if(this.iconsList.innerHTML="",e){var t=!0,i=!1,a=void 0;try{for(var n,r=Object.entries(e)[Symbol.iterator]();!(t=(n=r.next()).done);t=!0){var s=_slicedToArray(n.value,2),c=(s[0],s[1]);this.iconsList.appendChild(this.createIconPreview(c))}}catch(o){i=!0,a=o}finally{try{!t&&r["return"]&&r["return"]()}finally{if(i)throw a}}}}},{key:"createIconPreview",value:function(e){var t=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"fa-",a=document.createElement("a");a.dataset.title=e.name,a.setAttribute("title",e.name),a.dataset.icon=e.selector,a.dataset.filter=e.filter;var n=document.createElement("i");return n.className="iconpicker-icon-preview",e.displayPrefix.length&&(i=e.displayPrefix.split(" "),i.forEach(function(e){n.classList.add(e)})),n.classList.add(e.selector),a.appendChild(n),a.addEventListener("click",function(e){e.preventDefault(),t.preview.innerHTML="",t.element.value=e.target.classList,t.preview.appendChild(e.target.cloneNode(!0)),t.modal.classList.remove("is-active")}),a}},{key:"createModal",value:function(){var e=this;this.modal=document.createElement("div"),this.modal.className="modal",this.modal.classList.add("iconpicker-modal"),this.modal.id=this.id;var t=document.createElement("div");t.className="modal-background";var i=document.createElement("div");i.className="modal-card";var a=document.createElement("header");a.className="modal-card-head";var n=document.createElement("p");n.className="modal-card-title",n.innerHTML="iconPicker",this.modalHeaderSearch=document.createElement("input"),this.modalHeaderSearch.setAttribute("type","search"),this.modalHeaderSearch.setAttribute("placeholder","Search"),this.modalHeaderSearch.className="iconpicker-search",this.modalHeaderSearch.addEventListener("input",function(t){e.filter(t.target.value)});var r=document.createElement("button");if(r.className="delete",r.addEventListener("click",function(t){t.preventDefault(),e.modal.classList.remove("is-active")}),i.appendChild(a),this.modalBody=document.createElement("section"),this.modalBody.className="modal-card-body",this.options.iconSets.length>=1){var s=document.createElement("div");s.className="iconpicker-sets",s.classList.add("tabs"),this.modalSetTabs=document.createElement("ul"),this.options.iconSets.forEach(function(t){var i=document.createElement("li"),a=document.createElement("a");a.dataset.iconset=t.name,a.innerHTML=t.name,a.addEventListener("click",function(t){t.preventDefault(),e.modalSetTabs.querySelectorAll(".is-active").forEach(function(e){e.classList.remove("is-active")}),t.target.parentNode.classList.add("is-active"),e.drawIcons(e.icons[t.target.dataset.iconset]),e.filter(e.modalHeaderSearch.value)}),i.appendChild(a),e.modalSetTabs.appendChild(i)}),s.appendChild(this.modalSetTabs),i.appendChild(s)}this.iconsList=document.createElement("div"),this.iconsList.className="iconpicker-icons",a.appendChild(n),a.appendChild(this.modalHeaderSearch),a.appendChild(r),this.modalBody.appendChild(this.iconsList),i.appendChild(this.modalBody),this.modal.appendChild(t),this.modal.appendChild(i),document.body.appendChild(this.modal)}},{key:"filter",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return""===e?void this.iconsList.querySelectorAll("[data-filter]").forEach(function(e){e.classList.remove("is-hidden")}):(this.iconsList.querySelectorAll("[data-filter]").forEach(function(e){e.classList.remove("is-hidden")}),void this.iconsList.querySelectorAll('[data-filter]:not([data-filter*="'+e+'"])').forEach(function(e){e.classList.add("is-hidden")}))}}]),e}();ready(function(){var e=document.querySelectorAll('[data-action="iconPicker"]'),t={};e&&e.forEach(function(e){e.dataset.iconPicker||(e.dataset.iconPicker=new IconPicker(e,t))})});
